let isLead=0;function startGameMulti(e,t,l){let n=document.getElementById("game");n.classList.toggle("gone",!1),isLead=e?1:0,e&&(gameState.turn=1,gameState.initTime=+new Date,t(gameState),updateBoard())}function msgGame(e){}function endGame(){}function updateBoard(){}function startGame(){grid_c=e=>{console.log("Grid element "+e)};let a=(e,t,l,n)=>{for(i=0;i<5;i+=1)t&1<<i&&e.classList.add("l"+i);e.classList.toggle("p1",0==l),e.classList.toggle("p2",1==l),e.classList.toggle("ht",!!n)};ge_gone("game",!1);let e=[7,11,7,14,15,15,13,3,6,9];console.log(e),console.log(e.map(e=>(x=1&(e>>1^e>>3),e^(x<<1|x<<3))));let r={tn:0,tls:new Array(81).fill(0),own:new Array(81).fill(-1),ft:[e,e.map(e=>(x=1&(e>>1^e>>3),e^(x<<1|x<<3)))]};r.tls[40]=31,r.tls[27]=23,r.own[27]=0,r.tls[35]=29,r.own[35]=1;let g=new Array(99).fill(0).map((e,t)=>{let l=clone("gamebrd","tile");return((e,t)=>{let l=t%9,n=Math.floor(t/9);9==n&&(l=-1.5),10==n&&(l=9.5),9<=n&&(n=t%9*1.2+.3),e.style.left=100*l/9+"%",e.style.top=100*n/9+"%",e.style.width=e.style.height=100/9+"%"})(l,t),l.onclick=()=>grid_c(t),l});g.forEach((e,t)=>{t<81?a(e,r.tls[t],r.own[t]):t-9<81?a(e,r.ft[0][t-81],-1):a(e,r.ft[1][t-81-9],-1)});let c=(e,t,l,n,o)=>{var a=e%9+t,g=Math.floor(e/9)+l;if(a<0||9<=a||g<0||9<=g)return n?-10:0;l=r.tls[e+t+9*l];return l?!!(l&o)==!!n?1:-10:0};(()=>{var e=r.tn%2;let o=r.ft[e][0];gecl("gamebrd","p1",e),r.tls.forEach((e,t)=>{var l,n;l=t,n=o,0==r.tls[l]&&0<c(l,0,-1,1&n,4)+c(l,0,1,4&n,4)+c(l,1,0,2&n,8)+c(l,-1,0,8&n,2)&&a(g[t],o,-1,!0)})})()}function _init_lobby(){let l=io({upgrade:!1,transports:["websocket"]}),t=document.getElementById("board");ge("nick").value="user"+ +new Date%1e4,l.on("connect",()=>{}),l.on("lobby",e=>{t.innerHTML="",e.available.forEach(t=>{if(t.nick!=ge("nick").value){let e=clone("board","brde");e.textContent="Start Game with: "+t.nick+" - ["+t.level+"]",e.onclick=()=>{l.emit("reqstart",{opponent:t.id})}}})}),l.on("disconnect",()=>{}),l.on("playstart",e=>{ge_gone("lobby",!0),startGame(e.lead,e=>{l.emit("gamemsg",e)},e=>{l.emit("reqend")})}),l.on("playend",()=>{ge_gone("lobby",!1),endGame()}),l.on("gamemsg",e=>{msgGame(e)}),l.on("error",()=>{}),geclk("enter",()=>{l.emit("el",{nick:ge("nick").value,level:ge("lev").value}),ge_no("top",!0),ge_no("bot",!1)}),geclk("leave",()=>{l.emit("ll",{}),ge_no("top",!1),ge_no("bot",!0)})}var _lobby_up=!1;function start_lobby(){_lobby_up||_init_lobby(),_lobby_up=!0,ge_gone("lobby",!1)}function init(){startGame()}let ge=e=>document.getElementById(e),gecl=(e,t,l)=>ge(e).classList.toggle(t,l),geclk=(e,t)=>ge(e).onclick=t,ge_gone=(e,t)=>gecl(e,"gone",t),ge_no=(e,t)=>gecl(e,"no",t),clone=(e,t)=>{t=document.querySelector("#"+t).content.firstElementChild.cloneNode(!0);return ge(e).appendChild(t),t};